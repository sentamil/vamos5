<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="author" content="Satheesh">
<title>Easy Locator</title>
<link href="assets/css/bootstrap.css" rel="stylesheet">
<link href="../app/views/reports/bootstrap-datetimepicker.css" rel="stylesheet" type="text/css">
<link href="assets/css/simple-sidebar.css" rel="stylesheet">
<link href="assets/font-awesome-4.2.0/css/font-awesome.css" rel="stylesheet">
<link href="//code.ionicframework.com/ionicons/1.5.2/css/ionicons.min.css" rel="stylesheet" type="text/css">
<link href="../app/views/reports/AdminLTE/AdminLTE.css" rel="stylesheet">
<link href="../app/views/reports/table/font-awesome.css" rel="stylesheet" type="text/css">
</head>
<body ng-app="hist">
	<div id="wrapper" ng-controller="histCtrl">
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav">
                <li class="sidebar-brand"><a href="javascript:void(0);"><img src="assets/imgs/logo.png"/></i></a></li>
                <li class="track"><a href="../public/live"><div></div><label>Track</label></a></li>
                <li class="history"><a href="../public/replay"><div></div><label>History</label></a></li>
                <li class="alert01"><a href="../public/reports" class="active"><div></div><label>Reports</label></a></li>
                <li class="alert01"><a href="javascript:void(0);"><div></div><label>Statistics</label></a></li>
                <li class="sidebar-bottom"><a href="javascript:void(0);"><img src="assets/imgs/profile.png"/></a></li>
                <li><a href="http://128.199.217.144/vamo/public/logout"><img src="assets/imgs/logout.png"/></a></li>         
            </ul>
            <ul class="sidebar-subnav ">
                <li style="padding-left:25px;">
                	<div class="right-inner-addon" align="center"> 
                    <i class="fa fa-search"></i>
                    <input type="search" class="form-control" placeholder="Search" ng-model="searchbox" name="search" />
                    </div>
                </li>
                <li ng-repeat="location in locations" class="active"><a href="javascript:void(0);" ng-click="groupSelection(location.group, location.rowId)">{{location.group}}</a>
                    <ul class="nav nav-second-level">
                    <li ng-repeat="loc in location.vehicleLocations | filter:searchbox"><a href="history?vid={{loc.vehicleId}}" ng-class="{active: $index == selected, red:loc.status=='OFF'}" ng-click="genericFunction(loc.vehicleId, $index)">{{loc.vehicleId}} ({{loc.shortName}})</a></li>
                    </ul>
                </li>
            </ul>
        </div>
        <div id="page-content-wrapper">
            <div class="container-fluid">
            	<a href="#menu-toggle" id="menu-toggle"><img src="assets/imgs/drag.png"/></a>   
            	<div class="panel panel-default">
            	</div>   		
        	</div>
        <!-- /#page-content-wrapper -->
    	</div>
 
    <!-- AdminLTE css box-->
   
       <div class="col-md-12">
	       	<div class="box box-primary">
		        <div class="box-header" data-toggle="tooltip" title="" data-original-title="Header tooltip">
		            <h3 class="box-title">History Reports</h3>
		            <div class="box-tools pull-right">
		                <a href="downloadhistory?vid={{id}}&rid={{downloadid}}" target="_blank"><img src="../app/views/reports/image/Adobe.png" /></a>
		                <img style="cursor: pointer;" ng-click="exportData(downloadid)"  src="../app/views/reports/image/xls.png" />
		            </div>
		        </div>
		        <div class="row">
		        				<div class="col-md-1" align="center"></div>
                    			<div class="col-md-2" align="center">
                                	<div class="form-group">
                                    	<div class="input-group datecomp">
                                            <input type="text" ng-model="fromdate" class="form-control placholdercolor" id="dateFrom" placeholder="From date">
                                            <div class="input-group-addon"><i class="fa fa-calendar"></i></div>
                                    	</div>
                                  	</div>
                                </div>
                                <div class="col-md-2" align="center">
                                	<div class="form-group">
                                    	<div class="input-group datecomp">
                                            <input type="text" ng-model="fromtime" class="form-control placholdercolor" id="timeFrom" placeholder="From time">
                                            <div class="input-group-addon"><i class="glyphicon glyphicon-time"></i></div>
                                    	</div>
                                  	</div>
                                </div>
                                <div class="col-md-2" align="center">
                                	<div class="form-group">
                                    	<div class="input-group datecomp">
                                          	<input type="text" min-date="fromdate" ng-model="todate" class="form-control placholdercolor" id="dateTo" placeholder="To date">
                                          	<div class="input-group-addon"><i class="fa fa-calendar"></i></div>
                                    	</div>
                                  	</div>
                                </div>
                                <div class="col-md-2" align="center">
                                	<div class="form-group">
                                    	<div class="input-group datecomp">
                                          	<input type="text" ng-model="totime" class="form-control placholdercolor" id="timeTo" placeholder="To time">
                                          	<div class="input-group-addon"><i class="glyphicon glyphicon-time"></i></div>
                                    	</div>
                                  	</div>
                                </div>
                                <div class="col-md-2" align="center">
                                    <button ng-click="plotHist()">Plot History</button>
                                </div>
                               <div class="col-md-1" align="center"></div>
                            </div>
		        <div class="box-body col-md-9" id="statusreport">
		        	 <!-- // print '	<!-- Tabset -->
					 <tabset class="nav-tabs-custom">
			   			 <tab select="alertMe('Overspeed')" heading="Overspeed">
			   				 <p style="margin:0" class="page-header">Overspeed Report <span style="float: right;">From : {{fromdate}} {{fromtime}} - To : {{todate}} {{totime}}</span></p>
			   				 <div class="box-body table-responsive" id='overspeedreport'>
			   				 <table class="table table-bordered table-striped table-condensed table-hover">
			   				 	<thead>
								   	<tr style="text-align:center; font-weight: bold;" >
									  	<td colspan="3"><b>Vehical Group</b></td>
									  	<td >{{id}}</td>
									  	<td colspan="2"><b>Vehicle ID</b></td>
									  	<td colspan="2">{{hist.vehicleId}}</td>	
								  	</tr>
								  	<tr style="text-align:center; font-weight: bold;">
									  	<td colspan="3"><b>Register No</b></td>
								       	<td>{{hist.regNo}}</td>
								      	<td colspan="2"><b>Speed Limit</b></td>
								      	<td colspan="2">{{hist.overSpeedLimit}}</td>
								    </tr>
									<tr>
										<th class="id" custom-sort order="'lastSeen'" sort="sort" style="text-align:center;">Last Seen</th>
										<th class="id" custom-sort order="'speed'" sort="sort" style="text-align:center;">Speed</th>
										<th class="id" custom-sort order="'latitude'" sort="sort" style="text-align:center;">Location</th>
										<th class="id" custom-sort order="'isOverSpeed'" sort="sort" style="text-align:center;">Over Speed</th>
										<th class="id" custom-sort order="'odoDistance'" sort="sort" style="text-align:center;">Odo (DS)</th>
										<th class="id" custom-sort order="'tripDistance'"  sort="sort" style="text-align:center;">Trip (DS)</th>
										<th colspan="2" class="id" custom-sort order="''" sort="sort" style="text-align:center;">Google Map Link</th>
									</tr></thead>
									<tr ng-repeat="user in overspeeddata.slice().reverse() | orderBy:sort.sortingOrder:sort.reverse" class="active" style="text-align:center">
										<td>{{user.lastSeen}}</td>
										<td>{{user.speed}}</td>
										<td get-location lat={{user.latitude}} lon={{user.longitude}} title="{{locationname}}">{{user.latitude}},{{user.longitude}}</td>
										<td>{{user.isOverSpeed}}</td>
										<td>{{user.odoDistance}}</td>
										<td>{{user.tripDistance}}</td>
										<td><a href="https://www.google.com/maps?q=loc:{{user.latitude}},{{user.longitude}}" target="_blank">Link</a></td>						
									</tr>
									<!--tfoot>
								          <td colspan="10">
								            <div class="pagination">
								              <ul>
								                <li>
								                  <a href ng-click="prevPage()">« Prev</a>
								                </li>
								                <li ng-repeat="n in range()" ng-class="{active: n == currentPage}" ng-click="setPage(n)">
								                  <a href="#">{{n+1}}</a>
								                </li>
								                <li>
								                  <a href ng-click="nextPage()">Next »</a>
								                </li>
								              </ul>
								            </div>
								          </td>
								        </tfoot -->
							</table>
							</div>
			   			 </tab>
			   			 
			   			 
			   			 <tab select="alertMe('Movement')" heading="Movement">
			   				 <h4 style="margin:0" class="page-header">Movement Report</h4>
			   				 <div id='movementreport'>
			   				 <table class="table table-bordered table-striped table-condensed table-hover">
			   				 	<thead>
								   	<tr style="text-align:center; font-weight: bold;">
									  	<td colspan="2">Vehical Group</td>
									  	<td >{{id}}</td>
									  	<td colspan="1">Vehicle ID</td>
									  	<td >{{hist.vehicleId}}</td>					
								  	</tr>
								  	<tr style="text-align:center;font-weight: bold;">
									  	<td colspan="2">Register No</td>
								       	<td>{{hist.regNo}}</td>
								      	<td colspan="1">Speed Limit</td>
								      	<td>{{hist.overSpeedLimit}}</td>
								    </tr>
									<tr style="text-align:center" >
										<th class="id" custom-sort order="'lastSeen'" sort="sort" style="text-align:center;">Last Seen</th>
										<th class="id" custom-sort order="'speed'" sort="sort" style="text-align:center;">Speed</th>
										<th class="id" custom-sort order="'latitude'" sort="sort" style="text-align:center;">Location</th>
										<th class="id" custom-sort order="'isOverSpeed'" sort="sort" style="text-align:center;">Is Over Speed</th>
										<th class="id" custom-sort order="'insideGeoFence'" sort="sort" style="text-align:center;">Is GeoFence Breached</th>
									</tr></thead>
									 
													                
					                <tbody>
									<tr ng-repeat="user in movementdata | orderBy:sort.sortingOrder:sort.reverse " class="active" style="text-align:center">
										<td>{{user.lastSeen}}</td>
										<td>{{user.speed}}</td>
										<td get-location lat={{user.latitude}} lon={{user.longitude}} title="{{locationname}}">{{user.latitude}},{{user.longitude}}</td>
										<td>{{user.isOverSpeed}}</td>
										<td>{{user.insideGeoFence}}</td>
									</tr>
									</tbody>
							</table>
							</div>
			   			 </tab>
			   			 <tab select="alertMe('Stopped/Parked')" heading="Stopped/Parked">
			   				 <h4 style="margin:0" class="page-header">Stopped/Parked Report</h4>
			   				 <div id='stoppedparkingreport'>
			   				 <table class="table table-bordered  table-striped table-condensed table-hover">
			   				 	<thead>
								   	<tr style="text-align:center; font-weight: bold;">
									  	<td colspan="1"><b>Vehical Group</b></td>
									  	<td>{{id}}</td>
									  	<td colspan="1"><b>Vehicle ID</b></td>
									  	<td>{{hist.vehicleId}}</td>
									  	<td colspan="1"><b>Register No</b></td>
								       	<td>{{hist.regNo}}</td>				
								  	</tr>
								  	
									<tr style="text-align:center;font-weight: bold;">
										<th class="id" custom-sort order="'latitude'" sort="sort" style="text-align:center;">Location</th>
										<th class="id" custom-sort order="'lastSeen'" sort="sort" style="text-align:center;">Last Seen</th>
										<th colspan="2" class="id" custom-sort order="'parkedTime'" sort="sort" style="text-align:center;">Parked Time</th>
										<th colspan="2" class="id" custom-sort order="'totalParkedTime'" sort="sort" style="text-align:center;">Total Parked Time</th>
									</tr></thead>
									<tbody>
									<tr ng-repeat="user in parkeddata | orderBy:sort.sortingOrder:sort.reverse" class="active" style="text-align:center">
										<td get-location lat={{user.latitude}} lon={{user.longitude}} title="{{locationname}}">{{user.latitude}},{{user.longitude}}</td>
										<td>{{user.lastSeen}}</td>
										<td colspan="2">{{user.parkedTime}}</td>
										<td colspan="2">{{user.totalParkedTime}}</td>
									</tr>
									</tbody>								
							</table>
							</div>
			   			 </tab>
			   			 <tab select="alertMe('Geo Fence')" heading="Geo Fence">
			   				 <h4 style="margin:0" class="page-header">Geo Fence Report</h4>
			   				  <div id='geofencereport'>
			   				 <table class="table table-bordered table-striped table-condensed table-hover">
			   				 	<thead>
								   	<tr style="text-align:center; font-weight: bold;">
									  	<td colspan="1">Reg No</td>
									  	<td >{{hist.regNo}}</td>
									  	<td colspan="1">Vehicle ID</td>
									  	<td >{{hist.vehicleId}}</td>					
								  	</tr>
								  	<tr style="text-align:center; font-weight: bold;">
									  	<td colspan="1">GeoFenceId</td>
								       	<td>{{geofencedata[0].geoFenceId}}</td>
								      	<td colspan="1">GeoFenceType</td>
								      	<td>{{geofencedata[0].geoFenceType}}</td>
								    </tr>
									<tr style="text-align:center" >
										<th class="id" custom-sort order="'geoLocation'" sort="sort" style="text-align:center;">Location</th>
										<th class="id" custom-sort order="'inTime'" sort="sort" style="text-align:center;">In Time</th>
										<th class="id" custom-sort order="'proximity'" sort="sort" style="text-align:center;">Proximity</th>
										<th class="id" custom-sort order="'dangling'" sort="sort" style="text-align:center;">Dangling</th>
									</tr></thead>
									<tr ng-repeat="user in filteredTodos | orderBy:sort.sortingOrder:sort.reverse" class="active" style="text-align:center">
										<td>{{user.geoLocation}}</td>
										<td>{{user.inTime}}</td>
										<td>{{user.proximity}}</td>
										<td>{{user.dangling}}</td>
									</tr>
									 					
							</table>
							<pagination boundary-links="true" 
									    max-size="3" 
									    items-per-page="itemsPerPage"
									    total-items="geofencedata.length" 
									    ng-model="currentPage" 
									    ng-change="pageChanged()"></pagination>			
							</div>
			   			 </tab>
		    		 </tabset>
    		 		<!-- End Tabset -->
    		 		 
		        </div><!-- /.box-body -->
		        <div class="box-body col-md-3">
		        	<div class="small-box bg-aqua">
                                <div class="inner">
                                    <h3>
                                        {{hist.overSpeedInstances}}
                                    </h3>
                                    <p><b> Overspeed Instances
                                    	
                                    </b>
                                       
                                    </p>
                                    
                                </div>
                                <div class="icon">
                                    <i class="ion ion-stats-bars"></i>
                                </div>
                            </div>
                            
                            <div class="small-box bg-green">
                                <div class="inner">
                                    <h3>
                                        {{hist.topSpeed}}
                                    </h3>
                                    <p><b>Topspeed</b>
                                        
                                    </p>
                                    
                                </div>
                               <div class="icon">
                                    <i class="ion ion-speedometer"></i>
                                </div>
                            </div>
                            
                             <div class="small-box bg-yellow">
                                <div class="inner">
                                    <h3 ng-bind="msToTime(hist.totalRunningTime)">
                                      
                                    </h3>
                                    <p><b>Total Running Time</b>
                                        
                                    </p>
                                    
                                </div>
                               <div class="icon">
                                    <i class="ion ion-clock"></i>
                                </div>
                            </div>
                            
                             <div class="small-box bg-red">
                                <div class="inner">
                                    <h3 ng-bind="msToTime(hist.totalParkedTime)">
                                        
                                    </h3>
                                    <p><b>Total Parked Time</b>
                                        
                                    </p>
                                    
                                </div>
                               <div class="icon">
                                    <i class="ion ion-clock"></i>
                                </div>
                            </div>
                            
                             <div class="small-box bg-blue">
                                <div class="inner">
                                    <h3 ng-bind="hist.parkingCount">
                                        
                                    </h3>
                                    <p><b>No. of Parkings</b>
                                        
                                    </p>
                                    
                                </div>
                               <div class="icon">
                                    <i class="ion ion-clock"></i>
                                </div>
                            </div>
		        </div>
		    </div>	
        </div>
       
                 
	<script src="assets/js/jquery-1.11.0.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.8/angular.min.js"></script> 
    <script data-require="angular-ui-bootstrap@0.11.0" data-semver="0.11.0" src="http://angular-ui.github.io/bootstrap/ui-bootstrap-tpls-0.11.0.js"></script>
    <script src="../app/views/reports/ui-bootstrap-tpls-0.12.0.min.js"></script>
    <script src="../app/views/reports/moment.js"></script>
    <script src="../app/views/reports/FileSaver.js"></script>
    <script src="../app/views/reports/bootstrap-datetimepicker.js"></script>
    <script src="../app/views/reports/datatable/jquery.dataTables.js"></script>
    <script src="assets/js/static.js"></script>
	<script src="../app/views/reports/history.js"></script>
	

	<script>
	     
	    $("#example1").dataTable();
	      
		$("#menu-toggle").click(function(e) {
			e.preventDefault();
			$("#wrapper").toggleClass("toggled");
		});
		
        $(function () {
                $('#dateFrom, #dateTo').datetimepicker({
					format:'YYYY-MM-DD',
					useCurrent:true,
					pickTime: false
				});
				$('#timeFrom').datetimepicker({
					pickDate: false
				});
				$('#timeTo').datetimepicker({
					useCurrent:true,
					pickDate: false
				});
        });      
    </script>
    <style>
    	.alig{
    		style="text-align:center; font-weight: bold;"
    	}
    </style>
</body>
</html>

